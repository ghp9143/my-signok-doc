<!DOCTYPE html>
<html lang="ko">
    <head>
        <script src="/statics/js/loadHTML.js"></script>
        <script>
            loadHTML("/statics/include/head.html");
        </script>
        <title>회원가입</title>
    </head>

    <body>
        <main class="main main--background">
            <!-- // 상단헤더 -->
            <div class="container flex--column flex-justify--between">
                <div class="content-wrap flex--column gap--xl">
                    <div class="title-box">
                        <h1 class="">
                            <a>
                                <img src="" alt="로고">
                            </a>
                        </h1>
                        <ul class="bar">
                            <li class="bar__item is-active"></li>
                            <li class="bar__item is-active"></li>
                            <li class="bar__item"></li>
                        </ul>
    
                        <div class="title-box__title">
                            <p class="body--large font-weight--medium">싸인오케이에서 사용할<br>성함과 이메일을 입력해주세요</p>
                        </div>
                    </div>
                    <div class="box__content">
                        <form class="form">
                            <!-- input-area -->
                            <div class="input-area">
                                <label for="signup-mail" class="input-box__label">성명</label>
                                <div class="input-box">
                                    <input type="text"
                                    class="input"
                                    id="signup-name"
                                    placeholder="성명을 입력해주세요.">
                                    <img class="icon" src="/icon/remove-solid.svg"></img>
                                </div>
                                <p class="input-area__helper"></p>
                            </div>
                            <!-- // input-area -->
                            <!-- input-area 2 -->
                            <div class="input-area">
                                <label for="signup-mail" class="input-box__label">이메일</label>
                                <div class="input-box">
                                    <input type="text"
                                    class="input"
                                    id="signup-mail"
                                    placeholder="이메일주소를 입력해주세요.">
                                    <img class="icon" src="/icon/remove-solid.svg"></img>
                                </div>
                                <p class="input-area__helper"></p>
                            </div>
                            <!-- // input-area 2 -->
                        </form>
                    </div>
                    <!-- // box -->
                </div>
                <!-- //area -->
                <div class="flex--row flex-justify--between flex-align--center">
                    <a href="/step-1.html" class="button button--text button--small">이전</a>
                    <a href="/step-3.html" class="button button--primary button--small">다음</a>
                </div>
                
            </div>
           <!-- // container -->
        </main>
       
        
        <script>

            /** input 입력시 값 지우기 버튼 생성 */
            function checkInputLength(){
                this.value.length > 0 ?
                    $(this).next('.icon').show():
                    $(this).next('.icon').hide()
            }

            // 값 지우는 이벤트
            function handlingInputValue(){
                $(this).prev('.input').val('')
                    .parents('.input-area').removeClass('is-error')
                    .find('.input-area__helper').addClass('is-hide')
                $(this).hide()
            }

            $('.icon').on('click',handlingInputValue)

            /** 유효성검사 */
            function checkInputValue(){
                const regName = /^[가-힣]+$/;
                const regMail = /^[A-Za-z0-9_\.\-]+@[A-Za-z0-9\-]+\.[A-Za-z0-9\-]+/
            
                const currentInput = $(this).attr('id');
                const value = $(this).val();
                const inputBox =$(this).parents('.input-area');
                const helperText = $(this).parent().next('.input-area__helper');
            
                const errMsg = {
                    no_value_name: '성명을 입력해주세요.',
                    err_reg_name: '성명을 바르게 입력해주세요',
                    no_value_mail: '이메일을 입력해주세요.',
                    err_reg_mail: '이메일을 바르게 입력해주세요',
                    
                }


                // 이름
                if(currentInput.indexOf('mail') < 1){
                    if(value.length < 1){
                        inputBox.addClass('is-error')
                        helperText.text(errMsg.no_value_name)
                    }
                    else if(!regName.test(value)){
                        inputBox.addClass('is-error')
                        helperText.text(errMsg.err_reg_name)
                    }
                    else{
                       inputBox.removeClass('is-error')
                        helperText.text('')
                    }

                }
                // 이메일
                else{
                    if(value.length < 1){
                        inputBox.addClass('is-error')
                        helperText.text(errMsg.no_value_mail)

                    }
                    else if(!regMail.test(value)){
                        inputBox.addClass('is-error')
                        helperText.text(errMsg.err_reg_mail)
                    }
                    else{
                       inputBox.removeClass('is-error')
                        helperText.text('')
                    }
                }
                
            }
           
            $('.input').on('keyup',checkInputLength)
            $('.input').on('keyup',checkInputValue)

            function submitInput(e){
                e.preventDefault()

                for(let i = 0; i < $('.input').length; i++){
                    if($('.input').eq(i).val().length <= 0 ){
                        alert('성명과 이메일을 입력해주세요.')
                        return false;
                    }
                }

                if( $('.input-area.is-error').length > 0 ){
                    alert('입력한 정보를 확인해주세요.')
                    return false;
                }
                else{
                    location.href='/step-3.html'
                }
            }

            $('.button--primary').on('click',submitInput)

        </script>
    </body>
    
</html>